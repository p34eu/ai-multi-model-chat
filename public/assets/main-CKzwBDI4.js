(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=o(s);fetch(s.href,l)}})();let w=[],f={},S="",x=JSON.parse(localStorage.getItem("chatHistory"))||[],I=localStorage.getItem("language")||"bg",m=JSON.parse(localStorage.getItem("collapsedProviders"))||{},B={};function J(){return window.innerWidth<=768}Object.keys(m).length===0&&J();const Q={bg:{title:"AI Multi-Model Tool",models:"–ú–æ–¥–µ–ª–∏",refreshModels:"‚ü≥",expandCollapse:"–†–∞–∑–≥—ä–Ω–∏/–°–≥—ä–Ω–∏ –≤—Å–∏—á–∫–∏",history:"–ò—Å—Ç–æ—Ä–∏—è",clearHistory:"üóëÔ∏è",messagePlaceholder:"–ù–∞–ø–∏—à–∏ –≤—ä–ø—Ä–æ—Å, –∫–æ–π—Ç–æ –≤—Å–∏—á–∫–∏ –º–æ–¥–µ–ª–∏ –¥–∞ –æ—Ç–≥–æ–≤–æ—Ä—è—Ç...",sendButton:"–°—Ä–∞–≤–Ω–∏ –≤—Å–∏—á–∫–∏ –º–æ–¥–µ–ª–∏",typing:"–ú–æ–¥–µ–ª–∏—Ç–µ –æ—Ç–≥–æ–≤–∞—Ä—è—Ç‚Ä¶",modelInfo:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –º–æ–¥–µ–ª–∞",responseTime:"–í—Ä–µ–º–µ –∑–∞ –æ—Ç–≥–æ–≤–æ—Ä",question:"–í—ä–ø—Ä–æ—Å",noResponse:"–¢–æ–∑–∏ –º–æ–¥–µ–ª –Ω–µ –µ –æ—Ç–≥–æ–≤–æ—Ä–∏–ª.",comparisonTitle:"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –º–æ–¥–µ–ª–∏—Ç–µ",model:"–ú–æ–¥–µ–ª",time:"–í—Ä–µ–º–µ",answer:"–û—Ç–≥–æ–≤–æ—Ä",clearResults:"–ò–∑—á–∏—Å—Ç–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ",failedResponses:"–ù–µ—É—Å–ø–µ—à–Ω–∏ –æ—Ç–≥–æ–≤–æ—Ä–∏",language:"–ï–∑–∏–∫",english:"English",bulgarian:"–ë—ä–ª–≥–∞—Ä—Å–∫–∏"},en:{title:"AI Multi-Model Tool",models:"Models",refreshModels:"‚ü≥",expandCollapse:"Expand/Collapse All",history:"History",clearHistory:"üóëÔ∏è",messagePlaceholder:"Type a question for all models to answer...",sendButton:"Compare all models",typing:"Models are responding‚Ä¶",modelInfo:"Model Information",responseTime:"Response Time",question:"Question",noResponse:"This model did not respond.",comparisonTitle:"Model Comparison",model:"Model",time:"Time",answer:"Answer",clearResults:"Clear Results",failedResponses:"Failed Responses",language:"Language",english:"English",bulgarian:"–ë—ä–ª–≥–∞—Ä—Å–∫–∏"}};function a(e){return Q[I][e]||e}function _(e){I=e,localStorage.setItem("language",e),F()}function F(){document.title=a("title"),document.querySelector("#title").textContent=a("title"),document.querySelector("#message").placeholder=a("messagePlaceholder"),document.querySelector("#sendBtn").textContent=a("sendButton"),document.querySelectorAll(".sectionHeader h2")[0].textContent=a("models"),document.querySelectorAll(".sectionHeader h2")[1].textContent=a("history"),document.querySelector("#typingIndicator").textContent=a("typing");const e=document.querySelector("#comparisonTable h3");e&&(e.textContent=a("comparisonTitle"));const t=document.querySelectorAll(".compare th");t.length>=3&&(t[0].textContent=a("model"),t[1].textContent=a("time"),t[2].textContent=a("answer"));const o=document.querySelector("#selectedModelInfo h2");o&&(o.textContent=a("modelInfo"));const n=document.querySelectorAll("#selectedModelInfo .modelDetails div");n.length>=3&&(n[0].innerHTML=n[0].innerHTML.replace("–ê–∫—Ç—É–∞–ª–µ–Ω –∫—ä–º:",a("responseTime")+":"),n[1].innerHTML=n[1].innerHTML.replace("–í—Ä–µ–º–µ –∑–∞ –æ—Ç–≥–æ–≤–æ—Ä:",a("responseTime")+":"),n[2].innerHTML=n[2].innerHTML.replace("–í—ä–ø—Ä–æ—Å:",a("question")+":"));const s=document.querySelector("#selectedModelAnswer");s&&s.textContent==="–¢–æ–∑–∏ –º–æ–¥–µ–ª –Ω–µ –µ –æ—Ç–≥–æ–≤–æ—Ä–∏–ª."&&(s.textContent=a("noResponse"))}const R=document.getElementById("modelList"),j=document.getElementById("historyList"),H=document.getElementById("message"),Y=document.getElementById("sendBtn"),q=document.getElementById("typingIndicator"),T=document.getElementById("selectedModelInfo"),$=document.getElementById("selectedModelAnswer"),M=document.getElementById("comparisonTable");function A(e){const t={llama:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#8B4513"/></svg>',gemma:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#FFD700"/></svg>',qwen:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#FF4500"/></svg>',mixtral:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#00CED1"/></svg>',gpt:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#10a37f"/></svg>',claude:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#d97706"/></svg>',gemini:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#4285f4"/></svg>',default:'<svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" fill="#3b82f6"/></svg>'};if(!e||typeof e!="string")return t.default;const o=e.toLowerCase().replace(/^openai-/,"").replace(/^anthropic-/,"").replace(/^google-/,"");return o.includes("llama")?t.llama:o.includes("gemma")?t.gemma:o.includes("qwen")?t.qwen:o.includes("mixtral")?t.mixtral:o.includes("gpt")?t.gpt:o.includes("claude")?t.claude:o.includes("gemini")?t.gemini:t.default}function z(e){return!e||typeof e!="number"?"–Ω—è–º–∞ –¥–∞–Ω–Ω–∏":new Date(e*1e3).toLocaleDateString("bg-BG")}function V(e){return e<800?"speedFast":e<2e3?"speedMedium":"speedSlow"}function X(e){return e?(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),e=e.replace(/__(.*?)__/g,"<strong>$1</strong>"),e=e.replace(/\*(.*?)\*/g,"<em>$1</em>"),e=e.replace(/_(.*?)_/g,"<em>$1</em>"),e=e.replace(/`([^`]+)`/g,"<code>$1</code>"),e=e.replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>"),e=e.replace(/^### (.*$)/gm,"<h3>$1</h3>"),e=e.replace(/^## (.*$)/gm,"<h2>$1</h2>"),e=e.replace(/^# (.*$)/gm,"<h1>$1</h1>"),e=e.replace(/\n/g,"<br>"),e):""}function Z(e){const t=e.trim().split(`
`);if(t.length<2)return null;let o=-1;for(let r=0;r<t.length-1;r++)if(t[r].startsWith("|")&&t[r+1].includes("---")&&t[r+1].includes("|")){o=r;break}if(o===-1)return null;let n=o+2;for(let r=o+2;r<t.length;r++)if(t[r].startsWith("|"))n=r+1;else{n=r;break}const s=t.slice(o,n);if(s.length<2)return null;const l=s[0].split("|").slice(1,-1).map(r=>r.trim()),c=[];for(let r=2;r<s.length;r++){if(s[r].trim()==="")continue;const i=s[r].split("|").slice(1,-1).map(h=>h.trim());i.length===l.length&&c.push(i)}if(c.length===0)return null;const d=document.createElement("table");d.className="markdown-table";const p=document.createElement("thead"),g=document.createElement("tr");l.forEach(r=>{const i=document.createElement("th");i.textContent=r,g.appendChild(i)}),p.appendChild(g),d.appendChild(p);const L=document.createElement("tbody");return c.forEach(r=>{const i=document.createElement("tr");r.forEach(h=>{const E=document.createElement("td");E.textContent=h,i.appendChild(E)}),L.appendChild(i)}),d.appendChild(L),d}async function K(){const t=await(await fetch("/models")).json();!t.models||!Array.isArray(t.models)?w=[]:w=t.models.filter(n=>n&&n.id),B=t.providers||{},Object.keys(B).forEach(n=>{n in m||(m[n]=J())}),localStorage.setItem("collapsedProviders",JSON.stringify(m)),W()}function W(){R.innerHTML="";const e={};w.forEach(t=>{const o=t.provider||"Unknown";e[o]||(e[o]=[]),e[o].push(t)}),Object.keys(B).sort().forEach(t=>{const o=e[t]||[],n=B[t],s=n&&n.enabled&&n.hasApiKey,l=document.createElement("div");l.className=s?"providerGroup":"providerGroup inactive",l.dataset.provider=t;const c=document.createElement("div");c.className=s?"modelGroupHeader":"modelGroupHeader inactive",c.setAttribute("role","button"),c.setAttribute("aria-expanded",!m[t]),c.setAttribute("tabindex","0");const d=document.createElement("div");d.className="headerContent";const p=document.createElement("span");p.className="expandArrow",p.innerHTML=m[t]?"‚ñ∂":"‚ñº";const g=document.createElement("span"),L=s?"":' <span class="inactiveBadge">‚ö† No API Key</span>';g.innerHTML=`${t} (${o.length})${L}`,d.appendChild(p),d.appendChild(g),c.appendChild(d),c.addEventListener("click",()=>D(t)),c.addEventListener("keydown",i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),D(t))});const r=document.createElement("div");if(r.className="providerModels",m[t]&&(r.style.display="none"),!s||o.length===0){const i=document.createElement("div");i.className="inactiveMessage",i.innerHTML=`<span class="inactiveIcon">üîí</span> Add <code>${t.toUpperCase()}_API_KEY</code> to .env file to enable this provider`,r.appendChild(i)}else o.forEach(i=>{const h=i.id,E=i.provider||"Unknown",u=document.createElement("li");u.className="modelItem",u.dataset.modelId=h;const v=document.createElement("span");v.className="modelIcon",v.innerHTML=A(h);const y=document.createElement("div");y.className="modelNameContainer";const C=document.createElement("span");C.className="modelName",C.textContent=h;const b=document.createElement("span");b.className="modelProvider",b.textContent=E,y.appendChild(C);const k=document.createElement("span");k.className="modelStatus",k.textContent="‚Ä¶",u.appendChild(v),u.appendChild(y),u.appendChild(k),u.onclick=()=>te(h),r.appendChild(u)});l.appendChild(c),l.appendChild(r),R.appendChild(l)})}function D(e){m[e]=!m[e],localStorage.setItem("collapsedProviders",JSON.stringify(m));const t=document.querySelector(`.providerGroup[data-provider="${e}"]`);if(t){const o=t.querySelector(".modelGroupHeader"),n=o.querySelector(".expandArrow"),s=t.querySelector(".providerModels");m[e]?(n.innerHTML="‚ñ∂",s.style.display="none",o.setAttribute("aria-expanded","false")):(n.innerHTML="‚ñº",s.style.display="block",o.setAttribute("aria-expanded","true"))}}function ee(){const e=Object.values(m).every(t=>t===!0);Object.keys(m).forEach(t=>{m[t]=!e}),localStorage.setItem("collapsedProviders",JSON.stringify(m)),W()}document.getElementById("refreshModels").onclick=K;document.getElementById("expandCollapseBtn").onclick=ee;document.getElementById("clearHistory").onclick=()=>{x=[],localStorage.removeItem("chatHistory"),O()};function O(){j.innerHTML="",x.forEach((e,t)=>{const o=document.createElement("li");o.textContent=`${t+1}. ${e.question}`,o.onclick=()=>{S=e.question,f={...e.answersSnapshot},document.querySelectorAll(".modelItem").forEach(n=>n.classList.remove("activeModel")),T.classList.add("hidden"),$.classList.add("hidden"),U()},j.appendChild(o)})}function te(e){document.querySelectorAll(".modelItem").forEach(n=>{n.classList.toggle("activeModel",n.dataset.modelId===e)});const t=w.find(n=>n.id===e),o=f[e];T.classList.remove("hidden"),$.classList.remove("hidden"),T.innerHTML=`
    <h2>${A(e)} ${e}</h2>
    <div class="modelDetails">
      <div><strong>${a("responseTime")}:</strong> ${z(t==null?void 0:t.created)}</div>
      <div><strong>${a("responseTime")}:</strong> ${o?o.time+" ms":"–Ω—è–º–∞"}</div>
      <div><strong>${a("question")}:</strong> ${S||"–Ω—è–º–∞"}</div>
    </div>
  `,$.textContent=o?o.text:a("noResponse")}async function ne(e){f={},S=e,document.querySelectorAll(".modelStatus").forEach(n=>{n.textContent="‚Ä¶",n.className="modelStatus"}),q.classList.remove("hidden"),M.innerHTML="",T.classList.add("hidden"),$.classList.add("hidden");const t=w.map(n=>oe(e,n.id));(await Promise.allSettled(t)).forEach((n,s)=>{n.status==="rejected"&&console.error(`Model ${w[s].id} failed:`,n.reason)}),q.classList.add("hidden"),U(),x.push({question:e,answersSnapshot:{...f}}),localStorage.setItem("chatHistory",JSON.stringify(x)),O()}async function oe(e,t){const o=performance.now();try{const n=await fetch("/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,model:t})});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const s=n.body.getReader(),l=new TextDecoder;let c="",d=!1;const p=setTimeout(()=>{if(!d){console.warn(`Timeout for model: ${t}`),d=!0,f[t]={text:"‚ùå Request timeout",time:Math.round(performance.now()-o),error:!0};const g=document.querySelector(`.modelItem[data-model-id="${t}"] .modelStatus`);g&&(g.textContent="‚ùå",g.classList.add("error"))}},3e4);for(;!d;){const{value:g,done:L}=await s.read();if(L)break;const i=l.decode(g,{stream:!0}).split(`
`);for(const h of i){if(!h.startsWith("data:"))continue;const E=h.replace("data:","").trim();if(E==="[DONE]"){clearTimeout(p),d=!0;const u=performance.now(),v=Math.round(u-o);f[t]={text:c,time:v};const y=document.querySelector(`.modelItem[data-model-id="${t}"] .modelStatus`);y&&(y.textContent="‚úì",y.classList.add("answered",V(v)));return}try{const u=JSON.parse(E);if(u.error){clearTimeout(p),d=!0;const v=performance.now(),y=Math.round(v-o);let C="‚ùå";(u.error.includes("429")||u.error.toLowerCase().includes("quota"))&&(C="üí∞"),f[t]={text:`${C} Error: ${u.error}`,time:y,error:!0};const b=document.querySelector(`.modelItem[data-model-id="${t}"] .modelStatus`);b&&(b.textContent=C,b.classList.add("error"));return}u.token&&(c+=u.token)}catch{}}}}catch(n){const s=performance.now(),l=Math.round(s-o);f[t]={text:`‚ùå Network Error: ${n.message}`,time:l,error:!0};const c=document.querySelector(`.modelItem[data-model-id="${t}"] .modelStatus`);c&&(c.textContent="‚ùå",c.classList.add("error"))}if(!f[t]){console.warn(`No answer stored for model: ${t}`),f[t]={text:"‚ùå No response received",time:0,error:!0};const n=document.querySelector(`.modelItem[data-model-id="${t}"] .modelStatus`);n&&(n.textContent="‚ùå",n.classList.add("error"))}}function U(){if(!S||!Object.keys(f).length){M.innerHTML="";return}const e={},t={};if(Object.keys(f).forEach(o=>{const n=f[o];n.error||n.text.includes("‚ùå")||n.text.includes("No response")?t[o]=n:e[o]=n}),M.innerHTML=`
    <h3>${a("comparisonTitle")}</h3>
    <button id="clearResultsBtn" class="clear-btn">${a("clearResults")}</button>
    <div class="questionTitle"><strong>${a("question")}:</strong> ${S}</div>
  `,Object.keys(e).length>0){const o=G(e);M.appendChild(o)}if(Object.keys(t).length>0){const o=document.createElement("div");o.className="failed-responses collapsed",o.innerHTML=`
      <button class="toggle-failed-btn">
        <span class="toggle-icon">‚ñ∂</span>
        ${a("failedResponses")} (${Object.keys(t).length})
      </button>
      <div class="failed-content">
    `;const n=G(t);n.classList.add("failed-table"),o.querySelector(".failed-content").appendChild(n),o.innerHTML+="</div>",M.appendChild(o);const s=o.querySelector(".toggle-failed-btn");o.querySelector(".failed-content");const l=o.querySelector(".toggle-icon");s.addEventListener("click",()=>{o.classList.toggle("collapsed"),l.textContent=o.classList.contains("collapsed")?"‚ñ∂":"‚ñº"})}document.getElementById("clearResultsBtn").addEventListener("click",se)}function G(e){const t=document.createElement("table");t.className="compare";const o=document.createElement("tr");return[a("model"),a("time"),a("answer")].forEach(n=>{const s=document.createElement("th");s.textContent=n,o.appendChild(s)}),t.appendChild(o),Object.keys(e).forEach(n=>{const s=e[n],l=document.createElement("tr"),c=document.createElement("td");c.innerHTML=`${A(n)} ${n}`,l.appendChild(c);const d=document.createElement("td");d.textContent=`${s.time} ms`,l.appendChild(d);const p=document.createElement("td");p.className="answer-cell";const g=Z(s.text);g?p.appendChild(g):p.innerHTML=X(s.text),l.appendChild(p),t.appendChild(l)}),t}function se(){f={},S="",M.innerHTML="",T.classList.add("hidden"),$.classList.add("hidden"),q.classList.add("hidden")}async function N(){const e=H.value.trim();!e||!w.length||(H.value="",await ne(e))}Y.onclick=N;H.addEventListener("keydown",e=>{e.key==="Enter"&&N()});document.getElementById("questionArea").addEventListener("submit",e=>{e.preventDefault(),N()});K();O();F();q.classList.add("hidden");document.getElementById("langBg").addEventListener("click",()=>{_("bg"),P()});document.getElementById("langEn").addEventListener("click",()=>{_("en"),P()});function P(){document.getElementById("langBg").classList.toggle("active",I==="bg"),document.getElementById("langEn").classList.toggle("active",I==="en")}P();
